

# –í–∞—Ä–∏–∞–Ω—Ç 5 (Z9: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–µ—Ä–∏–µ–º –í–∏–ª–∫–æ–∫—Å–æ–Ω–∞)
# Œ± = 0.025
# K: I-–∞—è –≥—Ä. –ë–æ–ª–ú–µ–Ω—å—à–µ

data1 <- read.csv('https://kms.kpfu.ru/sites/default/files/unmanaged/forstud/–ö—É—Ä—Å–æ–≤–∞—è%20—Ä–∞–±–æ—Ç–∞%20–ø–æ%20–¢–í–ú–°/813/7/r2z1.csv')

X <- data1$X
Y <- data1$Y

# –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –µ–¥–∏–Ω—ã–π —Ä—è–¥, –ø–æ–º–µ—Ç–∏–≤ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ —Ä–∞–∑–Ω—ã–º –≤—ã–±–æ—Ä–∫–∞–º.
XY <-  c(X, Y)
XY_TYPE <-  rep(c("X", "Y"), each = 19)
DATASET <- data.frame(XY_TYPE, XY, stringsAsFactors = TRUE)

# –ü—Ä–æ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–∏–ø–∏—Å—ã–≤–∞—è –º–µ–Ω—å—à–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –º–µ–Ω—å—à–∏–π —Ä–∞–Ω–≥. –í—Å–µ–≥–æ —Ä–∞–Ω–≥–æ–≤ –ø–æ–ª—É—á–∏—Ç—Å—è (n1 + n2).
DATASET$rank <- rank(XY)

# –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É —Ä–∞–Ω–≥–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–π –≤—ã–±–æ—Ä–∫–∏.
DATASET <- na.omit(DATASET)
sumXY <- tapply(DATASET$rank, DATASET$XY_TYPE, FUN=sum)

# –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–æ–ª—å—à—É—é –∏–∑ –¥–≤—É—Ö —Ä–∞–Ω–≥–æ–≤—ã—Ö —Å—É–º–º.
sumXY[[1]]  # —á–∏—Å–ª–æ X
sumXY[[2]]  # —á–∏—Å–ª–æ Y
maxXY <- sumXY[[which.max(sumXY)]]

# –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ U –ø–æ —Ñ–æ—Ä–º—É–ª–µ:
# U = n1*n2 + nx¬∑(nx + 1)/2 ‚Äì Tx,
# –≥–¥–µ n1 ‚Äì –æ–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏ ‚Ññ1; n2 ‚Äì –æ–±—ä–µ–º –≤—ã–±–æ—Ä–∫–∏ ‚Ññ2;
# Tx ‚Äì –±–æ–ª—å—à–∞—è –∏–∑ –¥–≤—É—Ö —Ä–∞–Ω–≥–æ–≤—ã—Ö —Å—É–º–º;
# nx ‚Äì –æ–±—ä–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏: nx= max(n1, n2).
n1 <- length(na.omit(X))
n2 <- length(Y)
nx <- length(Y)
Tx <- sumXY[[2]]
U <- n1*n2 + ((nx*(nx+1))/2 ) - Tx

z <-  (U - (n1*n2/2)) / sqrt(n1*n2*(n1+n2+1)/12)
# —Å–º–æ—Ç—Ä–∏–º —Ç–∞–±–ª–∏—Ü—É http://www.z-table.com
# —É–º–Ω–æ–∂–∞–µ–º –Ω–∞ –¥–≤–∞ —Ç–∞–∫ –∫–∞–∫ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –æ–±–∞ —Ö–≤–æ—Å—Ç–∞
p <-  0.2451 * 2




# –º–∞—Ç –æ–∂–∏–¥–∞–Ω–∏–µ–º
MUw <- (n1*(n1+n2+1))/2 + 0.5
# –¥–∏—Å–ø–µ—Ä—Å–∏–µ–∏ÃÜ
SIGMAw <- (n1*n2*(n1+n2+1))/12
?pwilcox()
pp <- pwilcox(XY, 19, 18)
(sum(na.omit(pp)))
# p > ùõº - —Ö–æ—Ä–æ—à–µ–µ —Å–æ–≥–ª–∞—Å–∏–µ —Å –Ω—É–ª–µ–≤–æ–∏ÃÜ –≥–∏–ø–æ—Ç–µ–∑–æ–∏ÃÜ
# –ü—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è.
# pwilcox ‚Äî —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–ª–µ–Ω–∏—è –í–∏–ª–∫–æ–∫—Å–æ–Ω–∞
# dwilcox ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –í–∏–ª–∫–æ–∫—Å–æ–Ω–∞
# qwilcox ‚Äî –∫–≤–∞–Ω—Ç–∏–ª—å —Ä–∞—Å–ø—Ä–µ–¥–ª–µ–Ω–∏—è –í–∏–ª–∫–æ–∫—Å–æ–Ω–∞



# ==============================================================
# —Å–º–æ—Ç—Ä–∏–º —Ç–∞–±–ª–∏—Ü—É http://edu.mari.ru/rnoo/DocLib7/–í%20–ø–æ–º–æ—â—å%20—É—á–∏—Ç–µ–ª—é/–¢–∞–±–ª–∏—Ü—ã%20–ú–∞–Ω–Ω–∞-–£–∏—Ç–Ω–∏%20–∏%20–í–∏–ª–∫–æ–∫—Å–æ–Ω–∞.pdf
# –∏ –≤—ã—è—Å–Ω—è–µ–º —á—Ç–æ –°–∫—Ä–∏—Ç = 106
# –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –í–∏–ª–∫–æ–∫—Å–æ–Ω–∞ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–æ–∏ÃÜ —Ñ–æ—Ä–º—É–ª–æ–∏ÃÜ.
# –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ W –∞—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–∞ —Å
# –º–∞—Ç –æ–∂–∏–¥–∞–Ω–∏–µ–º
MUw <- (n1*(n1+n2+1))/2 + 0.5
# –¥–∏—Å–ø–µ—Ä—Å–∏–µ–∏ÃÜ
SIGMAw <- (n1*n2*(n1+n2+1))/12


# Œ¶ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
phi <- (U - MUw)/sqrt(SIGMAw)
wilcox.test(X, Y, paired = F, alternative = "two.sided")





